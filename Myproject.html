<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>Prediction of the manner in which participant did the exercise</title>

<script type="text/javascript">
window.onload = function() {
  var imgs = document.getElementsByTagName('img'), i, img;
  for (i = 0; i < imgs.length; i++) {
    img = imgs[i];
    // center an image if it is the only element of its parent
    if (img.parentElement.childElementCount === 1)
      img.parentElement.style.textAlign = 'center';
  }
};
</script>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: #990073
   }

   pre .number {
     color: #099;
   }

   pre .comment {
     color: #998;
     font-style: italic
   }

   pre .keyword {
     color: #900;
     font-weight: bold
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: #d14;
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>



<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}
pre {
  overflow-x: auto;
}
pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<h3>Prediction of the manner in which participant did the exercise</h3>

<h3>Goal</h3>

<p>The aim of this study is to build a model and predict the manner in which participant did the exercise.</p>

<h3>Prediction study design</h3>

<p>This section describes steps used to build the final model for prediction.</p>

<p><strong>Step1: Import and clean data</strong>
In this section, we imported csv data file and remove columns with missing values. These columns have been removed because they contain more than 98% of missing values. The final data set has no missing values.</p>

<pre><code class="r">#Set the work directory
setwd(&quot;C:/Users/hp Probook 4540s/Desktop/Machine learning&quot;)
#Import data in R
pml=read.csv(&quot;./pml-training.csv&quot;,na.strings=c(&quot;&quot;,&quot;#DIV/0!&quot;,NA))
#summary(pml)
#Select columns with no missing data
name=rep(FALSE,ncol(pml))
for (i in 1:ncol(pml)){
  if (length(na.omit(pml[,i]))==length(pml[,i])){
   name[i]=TRUE 
  }
}
pml=pml[,name]
</code></pre>

<p>*<em>Step2: split data into training/testing *</em></p>

<p>As we have a medium sample size, we split data into 60% for training data and 40% for testing data.</p>

<pre><code class="r">#Load caret and rpart packages
library(caret)
</code></pre>

<pre><code>## Loading required package: lattice
## Loading required package: ggplot2
</code></pre>

<pre><code class="r">library(rpart)
set.seed(2)
#Split data into training/testing
inTrain = createDataPartition(pml$classe,p=0.6,list=FALSE)
#Remove X and times variables
training = pml[ inTrain,-c(1,5)]
testing = pml[-inTrain,-c(1,5)]       
</code></pre>

<p>*<em>Step3: Cross-Validation strategy *</em></p>

<p>For cross-validation, we used 10-fold Cross Validation to estimate the accuracy of the predict model. As method, we used Stochastic Gradient Boosting and Trees to estimate parameters of the predict model. Base on accuracy, the best model is Stochastic Gradient Boosting.</p>

<pre><code class="r">set.seed(2)
# define training control with 10-fold cross validation to estimate
contr &lt;- trainControl(method=&quot;cv&quot;, number=10)
#train the model
mod_rf &lt;- train(training$classe~.,data=training,method=&quot;gbm&quot;,trControl=contr,verbose=FALSE)
</code></pre>

<pre><code>## Loading required package: gbm
## Loading required package: survival
## Loading required package: splines
## 
## Attaching package: &#39;survival&#39;
## 
## The following object is masked from &#39;package:caret&#39;:
## 
##     cluster
## 
## Loading required package: parallel
## Loaded gbm 2.1
## Loading required package: plyr
</code></pre>

<pre><code class="r">#Print the model parameters
print(mod_rf)
</code></pre>

<pre><code>## Stochastic Gradient Boosting 
## 
## 11776 samples
##    57 predictor
##     5 classes: &#39;A&#39;, &#39;B&#39;, &#39;C&#39;, &#39;D&#39;, &#39;E&#39; 
## 
## No pre-processing
## Resampling: Cross-Validated (10 fold) 
## 
## Summary of sample sizes: 10597, 10598, 10600, 10598, 10598, 10597, ... 
## 
## Resampling results across tuning parameters:
## 
##   interaction.depth  n.trees  Accuracy   Kappa      Accuracy SD
##   1                   50      0.8116483  0.7609891  0.013565668
##   1                  100      0.8882469  0.8585211  0.013311525
##   1                  150      0.9152517  0.8927212  0.013366955
##   2                   50      0.9323202  0.9143255  0.012244136
##   2                  100      0.9757980  0.9693763  0.005705705
##   2                  150      0.9903196  0.9877551  0.003327039
##   3                   50      0.9642499  0.9547555  0.009774983
##   3                  100      0.9923573  0.9903328  0.003124820
##   3                  150      0.9955844  0.9944147  0.002184103
##   Kappa SD   
##   0.017272125
##   0.016845229
##   0.016936401
##   0.015500780
##   0.007220660
##   0.004208227
##   0.012369188
##   0.003952518
##   0.002762633
## 
## Tuning parameter &#39;shrinkage&#39; was held constant at a value of 0.1
## Accuracy was used to select the optimal model using  the largest value.
## The final values used for the model were n.trees = 150,
##  interaction.depth = 3 and shrinkage = 0.1.
</code></pre>

<pre><code class="r">#Make a plot of Resampling Profile
trellis.par.set(caretTheme())
plot(mod_rf)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-3"/> </p>

<pre><code class="r">#make predictions with repart method
pred_rf &lt;- predict(mod_rf, testing)
# summarize results with lda and nb methods
confusionMatrix(pred_rf, testing$classe)
</code></pre>

<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction    A    B    C    D    E
##          A 2230    7    0    0    0
##          B    2 1508    6    0    1
##          C    0    3 1354    2    0
##          D    0    0    8 1281    4
##          E    0    0    0    3 1437
## 
## Overall Statistics
##                                           
##                Accuracy : 0.9954          
##                  95% CI : (0.9937, 0.9968)
##     No Information Rate : 0.2845          
##     P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
##                                           
##                   Kappa : 0.9942          
##  Mcnemar&#39;s Test P-Value : NA              
## 
## Statistics by Class:
## 
##                      Class: A Class: B Class: C Class: D Class: E
## Sensitivity            0.9991   0.9934   0.9898   0.9961   0.9965
## Specificity            0.9988   0.9986   0.9992   0.9982   0.9995
## Pos Pred Value         0.9969   0.9941   0.9963   0.9907   0.9979
## Neg Pred Value         0.9996   0.9984   0.9978   0.9992   0.9992
## Prevalence             0.2845   0.1935   0.1744   0.1639   0.1838
## Detection Rate         0.2842   0.1922   0.1726   0.1633   0.1832
## Detection Prevalence   0.2851   0.1933   0.1732   0.1648   0.1835
## Balanced Accuracy      0.9989   0.9960   0.9945   0.9971   0.9980
</code></pre>

<p>*<em>Step4: Prediction accuracy *</em></p>

<p>With Stochastic Gradient Boosting method, we found that prediction accuracy with testing sample is 99.5% with 95% confident interval =] 0.9937, 0.99,68[. Sensitivity and specificity for the prediction are both 99.91% and 99.88% respectively, suggesting that the model is good for prediction.</p>

<h3>Conclusion</h3>

<p>Stochastic Gradient Boosting method is the suitable method to build prediction model to predict the manner in which participant did the exercise.</p>

<p>C:\Users\hp Probook 4540s\Desktop\Machine learning</p>

</body>

</html>
